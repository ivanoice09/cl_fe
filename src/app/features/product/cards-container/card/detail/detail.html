@if (product) {
<div class="container my-4">
  <div class="row g-4">
    
    <div class="col-lg-5 col-md-6">
      <div
        class="d-flex align-items-center justify-content-center bg-light rounded shadow"
        style="height: 400px"
      >
        @if (product.thumbNailPhoto) {
        <img
          [src]="'data:image/gif;base64,' + product.thumbNailPhoto"
          alt="{{ product.name }}"
          style="max-width: 100%; max-height: 100%; object-fit: contain"
          
        />
        } @else {
        <img
          src="https://via.placeholder.com/400x400/0066cc/FFFFFF/?text=No+Image"
          alt="Placeholder"
          style="max-width: 100%; max-height: 100%; object-fit: contain"
        />
        }
      </div>
    </div>

    <div class="col-lg-7 col-md-6">
      <div class="card shadow-sm">
        <div class="card-body">
          <h1 class="card-title h3">{{ product.name }}</h1>

          <ul class="list-group list-group-flush mb-3">
            <li class="list-group-item"><strong>ID:</strong> {{ product.productId }}</li>
            <li class="list-group-item"><strong>Numero:</strong> {{ product.productNumber }}</li>
            <li class="list-group-item"><strong>Categoria:</strong> {{ product.categoryName }}</li>
            <li class="list-group-item"><strong>Prezzo:</strong> {{ product.listPrice | currency:'EUR' }}</li>
            <li class="list-group-item"><strong>Colore:</strong> {{ product.color ?? '---' }}</li>
            <li class="list-group-item"><strong>Taglia:</strong> {{ product.size ?? '---' }}</li>
            <li class="list-group-item"><strong>Peso:</strong> {{ product.weight ?? '---' }}</li>
          </ul>
          
          <button 
    type="button"
    class="btn-add-to-cart"
    (click)="addToCart()"
    [disabled]="isAddingToCart || !product">
    <span *ngIf="!isAddingToCart">üõí Aggiungi al Carrello</span>
    <span *ngIf="isAddingToCart">‚è≥ Aggiunta in corso...</span>
  </button>

        <!-- Messaggio Successo -->
        <div class="alert alert-success" *ngIf="addToCartSuccess">
          ‚úÖ Prodotto aggiunto al carrello con successo!
        </div>

        <!-- Messaggio Errore -->
        <div class="alert alert-error" *ngIf="addToCartError">
          ‚ùå {{ addToCartError }}
        </div>
        </div>
      </div>
    </div>
  </div>

  @if (availableLanguages.length > 0) {
  <div class="row mt-4">
    <div class="col-12">
      <div class="card shadow-sm">
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-center mb-3">
            <h3 class="card-title mb-0">Descrizione</h3>
            
            <div class="d-flex align-items-center gap-2">
              <label for="languageSelector" class="mb-0 me-2">
                <strong>Lingua:</strong>
              </label>
              <select 
                id="languageSelector"
                class="form-select form-select-sm"
                style="width: auto; min-width: 150px"
                [(ngModel)]="selectedLanguage"
              >
                @for (lang of availableLanguages; track lang) {
                <option [value]="lang">
                  {{ getLanguageName(lang) }}
                </option>
                }
              </select>
            </div>
          </div>

          <p class="text-muted" [style.direction]="selectedLanguage === 'ar' || selectedLanguage === 'he' ? 'rtl' : 'ltr'">
            {{ currentDescription }}
          </p>
        </div>
      </div>
    </div>
  </div>
  }

  <div class="row mt-4">
    <div class="col-12">
      <div class="card shadow-sm">
        <div class="card-body">
          <h3 class="card-title">Recensioni</h3>
          @for (r of product.reviews; track r.id) {
          <div class="border-bottom pb-3 mb-3">
            <strong>{{ r.userName }}</strong>
            <span class="badge bg-primary ms-2">{{ r.rating }} ‚≠ê</span>
            <p class="mt-2 mb-1">{{ r.text }}</p>
            <em class="text-muted small">{{ r.createdAt | date : 'dd/MM/yyyy HH:mm' }}</em>
          </div>
          } @empty {
          <p class="text-muted">Nessuna recensione disponibile.</p>
          }
        </div>
      </div>
    </div>
  </div>
</div>
} @else {
<div class="container my-4">
  <div class="d-flex justify-content-center">
    <div class="spinner-border" role="status">
      <span class="visually-hidden">Caricamento...</span>
    </div>
  </div>
</div>
}